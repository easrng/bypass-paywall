<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Coming Soon</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
  </head>
  <body>
    <noscript>This page needs JS</noscript>
    <div id="scriptsNeeded" style="display:none;">
    <style>
      * {
        box-sizing:border-box
      }
      body,
      html {
        font-family:system-ui,sans-serif;
        margin:0;
        padding:0;
        width:100%
      }
      .button {
        -webkit-appearance:none;
        align-items:center;
        border-radius:4px;
        box-shadow:none;
        display:inline-flex;
        font-size:0.9rem;
        height:2rem;
        justify-content:flex-start;
        line-height:1.5;
        padding:calc(.5em - 1px) calc(.75em - 1px);
        position:relative;
        vertical-align:top;
        -webkit-touch-callout:none;
        -webkit-user-select:none;
        -moz-user-select:none;
        -ms-user-select:none;
        user-select:none;
        background-color:#fef3c7;
        border:solid 1px #fde68a;
        color:#363636;
        cursor:pointer;
        justify-content:center;
        padding:calc(.5em - 1px) 0.25;
        text-align:center;
        white-space:nowrap;
        margin-right: 0.35rem;
      }
      [disabled].button {
        cursor:not-allowed
      }
      .button:hover {
        background-color:#fde68a;
        color:#363636
      }
      .button:focus {
        background-color:#fde68a;
        color:#363636
      }
      .button:active {
        box-shadow:0 0 0 .125em #f59e0b40
      }
      .button:active,
      .button:focus {
        outline:0;
        border-color:#f59e0b
      }
      .button:focus:not(:active) {
        box-shadow:0 0 0 .125em #f59e0b40
      }
      
      #isBroken {
        background: #fff8ea;
        position: fixed;
        bottom: 0;
        left: 1rem;
        padding: 0.35rem 0 0.35rem 0.35rem;
        border: 1px solid #fde68a;
        border-radius: 4px;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        border-bottom: none;
        display: flex;
        align-items: center;
        z-index: 2;
      }
    </style>
    <div id="isBroken" style="display:none"><span style="margin-right: 0.5rem;">Is the paywall gone?</span><button onclick="isBroken.style.display='none'" class="button">Yes</button><button onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLSddBuiiIVfPJMdf0lIbhIX7j1fW9FRx0iWTypVrEZTsun3Rpw/viewform?entry.1122477594='+encodeURIComponent(new URLSearchParams(location.search).get('url')));isBroken.style.display='none'" class="button">No</button></div>
    <iframe id="pageFrame" style="position: fixed;top: 0;left: 0;width: 100%;height: 100%;border: 0;margin: 0;padding: 0;"></iframe>
    </div>
    <script type="module">
      import hashUrl from "./hashurl.js";
      scriptsNeeded.style.display="";
      window.hashUrl=hashUrl;
      const pageFrame=document.querySelector("#pageFrame");
      const isBroken=document.querySelector("#isBroken");
      document.title="Loading - 13ft Ladder"
      pageFrame.srcdoc='<div style="position:fixed;width: 2rem;height:2rem;border-radius:50%;border: 0.25rem solid #ddd;border-top-color: #666;top:calc(50% - 1rem);left:calc(50% - 1rem);transform:rotate(0deg);animation-name:spin;animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:linear"></div><style type="text/css">@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>';
      try {
        let hash = await hashUrl(new URLSearchParams(location.search).get("url"));
        let url = "https://13ft-pages.s3.us-west-000.backblazeb2.com/"+hash+".html";
        if((await fetch(url, {method:"head"})).status===200){
          pageFrame.removeAttribute("srcdoc")
          pageFrame.addEventListener("load", () => {
            setTimeout(() => isBroken.style.display="", 1500);
          })
          document.title="13ft Ladder"
          pageFrame.src=url;
        } else {
          document.title="Page Not Yet Saved - 13ft Ladder"
          pageFrame.srcdoc="Page needs to be saved."
        }
      } catch (e) {
        document.title="Error - 13ft Ladder"
        pageFrame.srcdoc='<body style="width:100%;height:100vh;margin:0;padding:0;display:flex;align-items:center;justify-content:center;text-align:center;font-family:system-ui,sans-serif;font-size:1.25rem;color:#b00;background:#fff6f6">There was an error loading the page.</body>'
      }
    </script>
  </body>
</html>
